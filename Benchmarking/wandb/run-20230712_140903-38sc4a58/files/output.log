
------------------client client_id_list = [2]-------------------
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [__init__.py:101:init] args.rank = 2, args.process_id = 2, args.worker_num = 2
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [__init__.py:154:update_client_specific_args] data_silo_config is not defined in fedml_config.yaml
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [__init__.py:121:print_args] ==== args = {'yaml_config_file': 'config/fedml_config.yaml', 'run_id': '123', 'rank': 2, 'local_rank': 0, 'node_rank': 0, 'role': 'client', 'yaml_paths': ['config/fedml_config.yaml'], 'training_type': 'cross_silo', 'scenario': 'horizontal', 'using_mlops': False, 'random_seed': 0, 'bootstrap': 'config/bootstrap.sh', 'dataset': 'cifar10', 'data_cache_dir': '/root/fedml_data', 'partition_method': 'hetero', 'partition_alpha': 0.5, 'model': 'mobilenet_v3', 'image_size': None, 'input_size': 3, 'class_num': 10, 'model_file_cache_folder': './model_file_cache', 'global_model_file_path': './model_file_cache/global_model.pt', 'federated_optimizer': 'FedAvg', 'client_id_list': '[2]', 'client_num_in_total': 2, 'client_num_per_round': 2, 'comm_round': 5, 'epochs': 3, 'lr': 0.03, 'batch_size': 4, 'client_optimizer': 'sgd', 'weight_decay': 0.001, 'frequency_of_the_test': 1, 'worker_num': 2, 'using_gpu': False, 'gpu_mapping_file': 'config/gpu_mapping.yaml', 'gpu_mapping_key': 'mapping_default', 'backend': 'MQTT_S3', 'mqtt_config_path': '', 's3_config_path': '', 'log_file_dir': '/root/fedml-client/fedml/logs', 'enable_wandb': True, 'wandb_key': '7a0c8bb3ad2fcce7be9aac88060c2e71d3ff96cc', 'wandb_project': 'fedml', 'wandb_name': 'fedml_torch_image_classification', 'n_proc_in_silo': 1, 'proc_rank_in_silo': 0, 'comm': None, 'enable_cuda_rpc': False, 'cpu_transfer': False, 'process_id': 2, 'sys_perf_profiling': True, 'config_version': 'release', 'current_running_dir': '/root/fedml-client', 'os_name': 'Linux', 'version': 'release', 'device_id': '7f720a61-e7e3-4195-92e4-d717fe8865ce-docker', 'cloud_region': '', 'log_server_url': 'https://open.fedml.ai/fedmlLogsServer/logs/update'}
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [device.py:113:get_device] devide_type = cpu, gpu_mapping_file = None, gpu_mapping_key = None, gpu_id = None
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [ml_engine_adapter.py:147:get_torch_device] args = <fedml.arguments.Arguments object at 0x7f87ec2730>, using_gpu = False, device_id = None, device_type = cpu
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [gpu_mapping_cross_silo.py:16:mapping_processes_to_gpu_device_from_yaml_file_cross_silo] Training on device: cpu
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [device.py:131:get_device] device = cpu
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [efficient_loader.py:117:partition_data] *********partition data***************
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [without_reload.py:31:__build_truncated_dataset__] download = True
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [without_reload.py:31:__build_truncated_dataset__]
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [utils.py:143:download_url] Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /root/fedml_data/cifar-10-python.tar.gz
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:09:06] [INFO] [utils.py:143:download_url]




























































































































































100%|██████████████████████| 170498071/170498071 [05:14<00:00, 541946.92it/s]
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:22] [INFO] [utils.py:437:download_and_extract_archive] Extracting /root/fedml_data/cifar-10-python.tar.gz to /root/fedml_data
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:22] [INFO] [utils.py:437:download_and_extract_archive]
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:27] [INFO] [without_reload.py:31:__build_truncated_dataset__] download = True
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:27] [INFO] [without_reload.py:31:__build_truncated_dataset__]
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:28] [INFO] [cifar.py:137:download] Files already downloaded and verified
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:28] [INFO] [cifar.py:137:download]
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:29] [INFO] [efficient_loader.py:132:partition_data] N = 50000
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:29] [INFO] [efficient_loader.py:332:efficient_load_partition_data_cifar10] traindata_cls_counts = {0: {0: 2767, 1: 2899, 2: 56, 3: 2155, 4: 4790, 5: 586, 6: 4, 7: 42, 8: 5000, 9: 5000}, 1: {0: 2233, 1: 2101, 2: 4944, 3: 2845, 4: 210, 5: 4414, 6: 4996, 7: 4958}}
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:29] [INFO] [efficient_loader.py:344:efficient_load_partition_data_cifar10] train_dl_global number = 12500
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:29] [INFO] [efficient_loader.py:345:efficient_load_partition_data_cifar10] test_dl_global number = 2500
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:29] [INFO] [efficient_loader.py:357:efficient_load_partition_data_cifar10] client_idx = 0, local_sample_number = 23299
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:29] [INFO] [efficient_loader.py:370:efficient_load_partition_data_cifar10] client_idx = 0, batch_num_train_local = 5824, batch_num_test_local = 2500
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:29] [INFO] [efficient_loader.py:357:efficient_load_partition_data_cifar10] client_idx = 1, local_sample_number = 26701
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:29] [INFO] [efficient_loader.py:370:efficient_load_partition_data_cifar10] client_idx = 1, batch_num_train_local = 6675, batch_num_test_local = 2500
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:29] [INFO] [model_hub.py:22:create] create_model. model_name = mobilenet_v3, output_dim = 10
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [contribution_assessor_manager.py:16:_build_assessor] contribution_alg is not set, assessor is None
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [fedml_trainer_dist_adapter.py:37:__init__] Initiating Trainer
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [mqtt_s3_multi_clients_comm_manager.py:42:__init__] {'yaml_config_file': 'config/fedml_config.yaml', 'run_id': '123', 'rank': 2, 'local_rank': 0, 'node_rank': 0, 'role': 'client', 'yaml_paths': ['config/fedml_config.yaml'], 'training_type': 'cross_silo', 'scenario': 'horizontal', 'using_mlops': False, 'random_seed': 0, 'bootstrap': 'config/bootstrap.sh', 'dataset': 'cifar10', 'data_cache_dir': '/root/fedml_data', 'partition_method': 'hetero', 'partition_alpha': 0.5, 'model': 'mobilenet_v3', 'image_size': None, 'input_size': 3, 'class_num': 10, 'model_file_cache_folder': './model_file_cache', 'global_model_file_path': './model_file_cache/global_model.pt', 'federated_optimizer': 'FedAvg', 'client_id_list': '[2]', 'client_num_in_total': 2, 'client_num_per_round': 2, 'comm_round': 5, 'epochs': 3, 'lr': 0.03, 'batch_size': 4, 'client_optimizer': 'sgd', 'weight_decay': 0.001, 'frequency_of_the_test': 1, 'worker_num': 2, 'using_gpu': False, 'gpu_mapping_file': 'config/gpu_mapping.yaml', 'gpu_mapping_key': 'mapping_default', 'backend': 'MQTT_S3', 'mqtt_config_path': {'mqttWssHost': 'wss://open.fedml.ai/mqtt', 'BROKER_HOST': 'mqtt.fedml.ai', 'MQTT_PWD': 'G32BnPj59hk3MHj85rTC', 'BROKER_PORT': 1883, 'MQTT_KEEPALIVE': 180, 'MQTT_USER': 'admin'}, 's3_config_path': {'CN_S3_SAK': 'fpU7ED2Xht1UGYAQrX9j/UPwAlXhn0cAcJZXnNi+', 'CN_REGION_NAME': 'us-west-1', 'CN_S3_AKI': 'AKIAUAWARWF4SW36VYXP', 'BUCKET_NAME': 'fedml'}, 'log_file_dir': '/root/fedml-client/fedml/logs', 'enable_wandb': True, 'wandb_key': '7a0c8bb3ad2fcce7be9aac88060c2e71d3ff96cc', 'wandb_project': 'fedml', 'wandb_name': 'fedml_torch_image_classification', 'n_proc_in_silo': 1, 'proc_rank_in_silo': 0, 'comm': None, 'enable_cuda_rpc': False, 'cpu_transfer': False, 'process_id': 2, 'sys_perf_profiling': True, 'config_version': 'release', 'current_running_dir': '/root/fedml-client', 'os_name': 'Linux', 'version': 'release', 'device_id': '7f720a61-e7e3-4195-92e4-d717fe8865ce-docker', 'cloud_region': '', 'log_server_url': 'https://open.fedml.ai/fedmlLogsServer/logs/update', 'device': device(type='cpu')}
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [mqtt_s3_multi_clients_comm_manager.py:44:__init__] is browser device: False
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [mqtt_s3_multi_clients_comm_manager.py:45:__init__] origin client object [2]
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [mqtt_s3_multi_clients_comm_manager.py:46:__init__] client object [2]
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [mqtt_s3_multi_clients_comm_manager.py:53:__init__] MqttS3CommManager args client_id_list: [2]
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [mqtt_s3_multi_clients_comm_manager.py:87:__init__] mqtt_s3.init: client_num = 2
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [fedml_client_master_manager.py:30:__init__] self.client_real_ids = [2]
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:30] [INFO] [fedml_comm_manager.py:27:run] running
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:31] [INFO] [fedml_comm_manager.py:37:receive_message] communication backend is alive (loop_forever, sender 0 to receiver 0)
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:31] [INFO] [fedml_client_master_manager.py:143:send_client_status] send_client_status
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:31] [INFO] [fedml_client_master_manager.py:144:send_client_status] self.client_real_id = 2
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:31] [INFO] [mqtt_s3_multi_clients_comm_manager.py:316:send_message] mqtt_s3.send_message: MQTT msg sent
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:31] [INFO] [mqtt_manager.py:93:send_message] FedMLDebug - Send: topic (fedml_123_2), message ({"msg_type": 5, "sender": 2, "receiver": 0, "client_status": "ONLINE", "client_os": "Linux"})
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:37] [INFO] [mqtt_s3_multi_clients_comm_manager.py:195:_on_message_impl] mqtt_s3 receive msg {'msg_type': 1, 'sender': 0, 'receiver': 2, 'model_params_url': 'https://fedml.s3.amazonaws.com/fedml_123_0_1_66c3b8a4-101b-43bf-b078-bc91dc58cc66?AWSAccessKeyId=AKIAUAWARWF4SW36VYXP&Signature=2CWsygFqelWI4HZrUGTT6Fb0ymU%3D&Expires=1689621275', 'model_params_key': 'fedml_123_0_1_66c3b8a4-101b-43bf-b078-bc91dc58cc66', 'model_params': 'fedml_123_0_1_66c3b8a4-101b-43bf-b078-bc91dc58cc66', 'client_idx': '1', 'client_os': 'PythonClient'}
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:37] [INFO] [mqtt_s3_multi_clients_comm_manager.py:203:_on_message_impl] mqtt_s3 receive msg deviceType
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:37] [INFO] [mqtt_s3_multi_clients_comm_manager.py:208:_on_message_impl] mqtt_s3.on_message: use s3 pack, s3 message key fedml_123_0_1_66c3b8a4-101b-43bf-b078-bc91dc58cc66
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:37] [INFO] [remote_storage.py:213:read_model] temp_file_path = /root/fedml_cache/1837@a68a9eea-c3ef-488d-abdc-a2e66a6954f7/fedml_123_0_1_66c3b8a4-101b-43bf-b078-bc91dc58cc66
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:39] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 1024.00 KB, progress 5%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:41] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 2048.00 KB, progress 10%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:42] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 3072.00 KB, progress 15%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:43] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 4096.00 KB, progress 20%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:45] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 5120.00 KB, progress 25%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:47] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 6144.00 KB, progress 30%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:49] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 7168.00 KB, progress 35%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:51] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 8192.00 KB, progress 40%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:53] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 9216.00 KB, progress 45%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:54] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 10240.00 KB, progress 50%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:56] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 11264.00 KB, progress 55%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:14:58] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 12288.00 KB, progress 60%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:00] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 13312.00 KB, progress 65%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:01] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 14336.00 KB, progress 70%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:18] [INFO] [remote_storage.py:226:read_model_progress] model readed from S3 size 20332.01 KB, progress 100%
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:19] [INFO] [mqtt_s3_multi_clients_comm_manager.py:226:_on_message_impl] mqtt_s3.on_message: model params length 350
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:19] [INFO] [mqtt_s3_multi_clients_comm_manager.py:231:_on_message_impl] mqtt_s3.on_message: model url https://fedml.s3.amazonaws.com/fedml_123_0_1_66c3b8a4-101b-43bf-b078-bc91dc58cc66?AWSAccessKeyId=AKIAUAWARWF4SW36VYXP&Signature=2CWsygFqelWI4HZrUGTT6Fb0ymU%3D&Expires=1689621275
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:19] [INFO] [mqtt_s3_multi_clients_comm_manager.py:188:_notify] mqtt_s3.notify: msg type = 1
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:19] [INFO] [fedml_comm_manager.py:39:receive_message] receive_message. msg_type = 1, sender_id = 0, receiver_id = 2
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:19] [INFO] [fedml_client_master_manager.py:79:handle_message_init] data_silo_index = 1
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:19] [INFO] [fedml_client_master_manager.py:172:__train] #######training########### round_id = 0
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:19] [INFO] [__init__.py:16:event] FedMLDebug edge_id = None, event_name = train, START = True
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:15:20] [INFO] [classification_trainer.py:46:train] Epoch: 1/3 | Batch: 0/6675 | Loss: 7.115625858306885
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:16:08] [INFO] [classification_trainer.py:46:train] Epoch: 1/3 | Batch: 100/6675 | Loss: 3.446913242340088
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:16:57] [INFO] [classification_trainer.py:46:train] Epoch: 1/3 | Batch: 200/6675 | Loss: 1.3792657852172852
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:17:45] [INFO] [classification_trainer.py:46:train] Epoch: 1/3 | Batch: 300/6675 | Loss: 1.9845020771026611
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:18:34] [INFO] [classification_trainer.py:46:train] Epoch: 1/3 | Batch: 400/6675 | Loss: 2.1757490634918213
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:19:22] [INFO] [classification_trainer.py:46:train] Epoch: 1/3 | Batch: 500/6675 | Loss: 2.555713415145874
[FedML-Client @device-id-2] [Wed, 12 Jul 2023 19:20:11] [INFO] [classification_trainer.py:46:train] Epoch: 1/3 | Batch: 600/6675 | Loss: 2.255638360977173
Traceback (most recent call last):
  File "/home/saintlab/network-auto-configuration/Raspberry-Pi-Projects/Projects/FedML/python/examples/cross_silo/mqtt_s3_fedavg_cifar10_lr_example/torch_client.py", line 23, in <module>
    fedml_runner = FedMLRunner(args, device, dataset, model, trainer, aggregator)
  File "/usr/local/lib/python3.9/dist-packages/fedml/runner.py", line 51, in __init__
    self.runner = init_runner_func(
  File "/usr/local/lib/python3.9/dist-packages/fedml/runner.py", line 125, in _init_cross_silo_runner
    runner = Client(
  File "/usr/local/lib/python3.9/dist-packages/fedml/cross_silo/fedml_client.py", line 18, in __init__
    client_initializer.init_client(
  File "/usr/local/lib/python3.9/dist-packages/fedml/cross_silo/client/client_initializer.py", line 49, in init_client
    client_manager.run()
  File "/usr/local/lib/python3.9/dist-packages/fedml/cross_silo/client/fedml_client_master_manager.py", line 187, in run
    super().run()
  File "/usr/local/lib/python3.9/dist-packages/fedml/core/distributed/fedml_comm_manager.py", line 28, in run
    self.com_manager.handle_receive_message()
  File "/usr/local/lib/python3.9/dist-packages/fedml/core/distributed/communication/mqtt_s3/mqtt_s3_multi_clients_comm_manager.py", line 327, in handle_receive_message
    self.run_loop_forever()